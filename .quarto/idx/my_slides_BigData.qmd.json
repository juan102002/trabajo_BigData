{"title":"La vivienda, una mirada a Europa y a España","markdown":{"yaml":{"title":"La vivienda, una mirada a Europa y a España","date":"2025-12-16","date-format":"short","format":{"revealjs":{"scrollable":true,"slide-level":2,"height":900,"width":1600,"toc":false,"center-title-slide":true,"title-slide-attributes":{"data-background-color":"#562457"},"preview-links":"auto","link-external-newwindow":true,"transition":"fade","fontcolor":"#262d36","highlight-style":"a11y","code-line-numbers":true,"number-sections":false,"slide-number":"c/t","incremental":false}},"execute":{"echo":true,"eval":true,"warning":false,"message":false},"footer":"Slides hechas con [Quarto y con sueño](https://quarto.org/)\n","theme":"night"},"headingText":"Intro","containsRefs":false,"markdown":"\n\n\n\n\nVamos a utilizar datos de:\n\n- Eurostat\n\n. . .\n\n- La  OECD\n\n. . .\n\n- El INE\n\n. . .\n\n*los paquetes han sido cargados en un chunk de codigo que no se ve gracias a \"include: false\".\n```{r}\n#| include: false\n#| message: false\n#| warning: false\n#install.packages(\"eurostat\")\n#install.packages(\"tidyverse\")\n#install.packages(\"ggplot2\")\n#install.packages(\"gganimate\")\n#install.packages(\"ggthemes\")\n#install.packages(\"gt\")\n#install.packages(\"gtExtras\")\n#install.packages(\"tidyr\")\n#install.packages(\"sf\")\n#install.packages(\"giscoR\")\n#install.packages(\"ragg\")\n#install.packages(\"gifski\")\n#install.packages(\"lubridate\")\n#install.packages(\"DT\")\n#install.packages(\"pjpv.curso.R.2022\")\n#install.packages(\"classInt\")\n#install.packages(\"stringr\")\n#install.packages(\"pxR\")\n#install.packages(\"devtools\")\n\nlibrary(pxR)\nlibrary(eurostat)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(gganimate)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\nlibrary(tidyr)\nlibrary(sf)        \nlibrary(giscoR)\nlibrary(ragg)\n\nlibrary(lubridate)\nlibrary(DT)\ndevtools::install_github(\"perezp44/pjpv.curso.R.2022\")\nlibrary(classInt)\nlibrary(stringr)\n\n#Usamos esto para solucionar problemas con los gráficos animados\nlibrary(gifski)\n```\n\n## En Europa donde sube y donde no sube el precio del alquiler {background-color=\"grey\"}\n\n::: {.panel-tabset}\n## Tabla 1 (mal)\n\n```{r}\n#| include: false\n#| eval: true\n#Escogemos los datos de la página de Eurostat\nmy_table <- \"prc_hicp_aind\"\n\neurostat::label_eurostat_tables(my_table)\n\n#Creamos el dataframe asociado al índice de IPC de Eurostat y filtramos\ndf <- eurostat::get_eurostat(my_table, time_format = \"raw\")   \n```\n\n```{r}\n#| echo: false\ndf_alquileres_index <- df %>%\n                        filter(coicop == \"CP041\",\n                        !geo %in% c(\"EU27_2020\", \"EA19\", \"EU28\", \n                                    \"EA\", \"EA20\",\"EA19\", \"US\", \n                                    \"XK\", \"TR\", \"RS\", \"AL\", \"MK\", \n                                    \"ME\", \"UK\", \"EEA\", \"EU\")) %>%\n                        label_eurostat() %>%\n                        filter(unit == \"Annual average index\") %>%\n                        dplyr::rename(paises = geo,\n                               año = TIME_PERIOD) %>%\n                        mutate(año = as.numeric(año)) %>%\n                        select(-freq) \n\n##Top (Los 6 que más han crecido desde 2015 hasta 2024)\ndf_alquileres_top_6_2024 <- df_alquileres_index %>%\n                             filter(año == 2024) %>%\n                             slice_max(values, n=6) \n\ntabla_df_alquileres_top_6_2024 <- df_alquileres_top_6_2024 %>%\n                                   gt() %>%\n                                   gt_theme_excel() %>% \n                                   tab_header(title = \"Tabla 1: Incremento del precio del alquiler\\nen los 6 países que más ha crecido\",\n                                               subtitle = \"TOP 6\") %>% \n                                   tab_footnote(footnote = \"Eurostat 2025\") \n\ntabla_df_alquileres_top_6_2024\n```\n\nAl pasar una tabla de un archivo html a formato slides es necesario realizar ajustes de tamaño de la tabla y el texto que ahi dentro de esta para que se vea bien.\n\n## Tabla 2 (bien)\n\n```{r}\n#| echo: false\n#Nontop (Los 6 que menos han crecido desde 2015 hasta 2024)\ndf_alquileres_nontop_6_2024 <- df_alquileres_index %>%\n                                filter(año == 2024) %>%\n                                slice_min(values, n=6)\n\ntabla_df_alquileres_nontop_6_2024 <- df_alquileres_nontop_6_2024 %>%\n                                gt() %>% \n                                gt_theme_excel() %>% \n                                tab_header(title = \"Tabla 2: Incremento del precio del alquiler\\nen los 6 países que menos ha crecido\",\n                                           subtitle = \"NONTOP 6\") %>% \n                                tab_footnote(footnote = \"Eurostat 2025\") %>%\n                                  gt::tab_options(table.width = pct(100)) %>%\n                                   tab_options(table.font.size = \"18pt\", heading.title.font.size = \"30pt\", data_row.padding = \"8px\") \n\ntabla_df_alquileres_nontop_6_2024\n```\n\n## Código correcto\n\n```{r}\n#| include: true\n#| eval: false\n#Nontop (Los 6 que menos han crecido desde 2015 hasta 2024)\ndf_alquileres_nontop_6_2024 <- df_alquileres_index %>%\n                                filter(año == 2024) %>%\n                                slice_min(values, n=6)\n\ntabla_df_alquileres_nontop_6_2024 <- df_alquileres_nontop_6_2024 %>%\n                                gt() %>% \n                                gt_theme_excel() %>% \n                                tab_header(title = \"Tabla 2: Incremento del precio del alquiler\\nen los 6 países que menos ha crecido\",\n                                           subtitle = \"NONTOP 6\") %>% \n                                tab_footnote(footnote = \"Eurostat 2025\") %>%\n                                  tab_options(table.width = pct(100), table.font.size = \"18pt\", heading.title.font.size = \"30pt\", data_row.padding = \"8px\") \n\ntabla_df_alquileres_nontop_6_2024\n```\n:::\n\n## Grafico y conclusiones\n::: {.incremental}\n:::: {.columns style=\"align-items: center;\"}\n\n::: {.column width=\"50%\"}\n```{r}\n#| echo: false\n#| fig-align: center\n#| fig-height: 9\nurl_ocde <- \"https://sdmx.oecd.org/public/rest/data/OECD.SDD.TPS,DSD_PRICES@DF_PRICES_ALL,1.0/CAN+AUS+BEL+FRA+DEU+ITA+JPN+NLD+ESP+CHE+SWE+GBR+USA+OECD+EU27_2020.A.N.CPI.IX.CP041.N.?startPeriod=1996&endPeriod=2024&dimensionAtObservation=AllDimensions&format=csvfilewithlabels\"\n\n#Creamos el archivo y descargamos los datos\ndir.create(\"datos\")\n\nruta_ocde <- \"./datos/alquileres_ocde.csv\"\n\ncurl::curl_download(url_ocde, ruta_ocde) \n\nalquileres_ocde <- read_csv(ruta_ocde)\n\n#Filtramos los datos\nalquileres_ocde <- alquileres_ocde %>%\n                   select(Measure, BASE_PER, EXPENDITURE, Expenditure,                                         `Reference area`, TIME_PERIOD, OBS_VALUE) %>%\n                   mutate(año = TIME_PERIOD,\n                          values = OBS_VALUE,\n                          país = `Reference area`)\n  \n#Creamos el gráfico \ngráfico <- ggplot(alquileres_ocde, aes(x = año, y = values, color = país)) +\n            geom_line(size = 1.4) +\n            labs(title = \"Gráfico 7: Incremento del precio del alquiler (Base 2015) G-12\", \n                  x = \"Año\", y = \"Porcentaje (Base 2015)\",\n                 caption = \"Fuente: OCDE 2025\") +\n            scale_x_continuous(breaks = seq(1996, 2024, by = 2)) +\n            scale_y_continuous(breaks = seq(50, 150, by = 12.5),\n                               limits = c(50, 150),\n                               expand = c(0, 0)) +\n            theme_stata() +\n            theme(legend.position = \"none\",\n                  axis.text.x = element_text(angle = 90, vjust = 0.5),\n                  axis.text.y = element_text(angle = 0)) +\n            geom_text(aes(label = país))\n  \n#Animámos el gráfico\ngráfico_animado <- gráfico + transition_reveal(año)+\n  enter_fade() + \n  exit_fade()\n\ngráfico_animado\n```\n\n:::\n\n::: {.column width=\"50%\"}\n- Vemos claramente como el año base es 2015.\n\n<br>\n\n- Japón (linea azul) no tiene apenas incremento en el precio de la vivienda.\n\n<br>\n\n- Estados Unidos (rosa), en cambio, lidera la carrera.\n\n:::\n\n::::\n:::\n\n\n\n## Grafico y conclusiones (con tabset)\n::: {.incremental}\n\n:::: {.columns style=\"align-items: center;\"}\n\n::: {.column width=\"50%\"}\n\n::: {.panel-tabset}\n\n## Grafico\n\n```{r}\n#| echo: false\n#| fig-align: center\n#| fig-height: 9\nurl_ocde <- \"https://sdmx.oecd.org/public/rest/data/OECD.SDD.TPS,DSD_PRICES@DF_PRICES_ALL,1.0/CAN+AUS+BEL+FRA+DEU+ITA+JPN+NLD+ESP+CHE+SWE+GBR+USA+OECD+EU27_2020.A.N.CPI.IX.CP041.N.?startPeriod=1996&endPeriod=2024&dimensionAtObservation=AllDimensions&format=csvfilewithlabels\"\n\n#Creamos el archivo y descargamos los datos\ndir.create(\"datos\")\n\nruta_ocde <- \"./datos/alquileres_ocde.csv\"\n\ncurl::curl_download(url_ocde, ruta_ocde) \n\nalquileres_ocde <- read_csv(ruta_ocde)\n\n#Filtramos los datos\nalquileres_ocde <- alquileres_ocde %>%\n                   select(Measure, BASE_PER, EXPENDITURE, Expenditure,                                         `Reference area`, TIME_PERIOD, OBS_VALUE) %>%\n                   mutate(año = TIME_PERIOD,\n                          values = OBS_VALUE,\n                          país = `Reference area`)\n  \n#Creamos el gráfico \ngráfico <- ggplot(alquileres_ocde, aes(x = año, y = values, color = país)) +\n            geom_line(size = 1.4) +\n            labs(title = \"Gráfico 7: Incremento del precio del alquiler (Base 2015) G-12\", \n                  x = \"Año\", y = \"Porcentaje (Base 2015)\",\n                 caption = \"Fuente: OCDE 2025\") +\n            scale_x_continuous(breaks = seq(1996, 2024, by = 2)) +\n            scale_y_continuous(breaks = seq(50, 150, by = 12.5),\n                               limits = c(50, 150),\n                               expand = c(0, 0)) +\n            theme_stata() +\n            theme(legend.position = \"none\",\n                  axis.text.x = element_text(angle = 90, vjust = 0.5),\n                  axis.text.y = element_text(angle = 0)) +\n            geom_text(aes(label = país))\n  \n#Animámos el gráfico\ngráfico_animado <- gráfico + transition_reveal(año)+\n  enter_fade() + \n  exit_fade()\n\ngráfico_animado\n```\n\n## Código\n\n```{r}\n#| include: true\n#| eval: false\n#| fig-align: center\n#| fig-height: 9\nurl_ocde <- \"https://sdmx.oecd.org/public/rest/data/OECD.SDD.TPS,DSD_PRICES@DF_PRICES_ALL,1.0/CAN+AUS+BEL+FRA+DEU+ITA+JPN+NLD+ESP+CHE+SWE+GBR+USA+OECD+EU27_2020.A.N.CPI.IX.CP041.N.?startPeriod=1996&endPeriod=2024&dimensionAtObservation=AllDimensions&format=csvfilewithlabels\"\n\n#Creamos el archivo y descargamos los datos\ndir.create(\"datos\")\n\nruta_ocde <- \"./datos/alquileres_ocde.csv\"\n\ncurl::curl_download(url_ocde, ruta_ocde) \n\nalquileres_ocde <- read_csv(ruta_ocde)\n\n#Filtramos los datos\nalquileres_ocde <- alquileres_ocde %>%\n                   select(Measure, BASE_PER, EXPENDITURE, Expenditure,                                         `Reference area`, TIME_PERIOD, OBS_VALUE) %>%\n                   mutate(año = TIME_PERIOD,\n                          values = OBS_VALUE,\n                          país = `Reference area`)\n  \n#Creamos el gráfico \ngráfico <- ggplot(alquileres_ocde, aes(x = año, y = values, color = país)) +\n            geom_line(size = 1.4) +\n            labs(title = \"Gráfico 7: Incremento del precio del alquiler (Base 2015) G-12\", \n                  x = \"Año\", y = \"Porcentaje (Base 2015)\",\n                 caption = \"Fuente: OCDE 2025\") +\n            scale_x_continuous(breaks = seq(1996, 2024, by = 2)) +\n            scale_y_continuous(breaks = seq(50, 150, by = 12.5),\n                               limits = c(50, 150),\n                               expand = c(0, 0)) +\n            theme_stata() +\n            theme(legend.position = \"none\",\n                  axis.text.x = element_text(angle = 90, vjust = 0.5),\n                  axis.text.y = element_text(angle = 0)) +\n            geom_text(aes(label = país))\n  \n#Animámos el gráfico\ngráfico_animado <- gráfico + transition_reveal(año)+\n  enter_fade() + \n  exit_fade()\n\ngráfico_animado\n```\n\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n- Vemos claramente como el año base es 2015.\n\n<br>\n\n- Japón (linea azul) no tiene apenas incremento en el precio de la vivienda.\n\n<br>\n\n- Estados Unidos (rosa), en cambio, lidera la carrera.\n\n:::\n\n::::\n:::\n\n## Mapa dinámico\n\n```{r}\n#| include: false\n#| eval: true\nmy_table <- \"prc_hicp_aind\"\n\neurostat::label_eurostat_tables(my_table)\n```\n\n\n```{r}\n#| echo: false\n\ndf <- eurostat::get_eurostat(my_table, time_format = \"raw\") \n\ndf_alquileres_anual <- df %>%\n                        filter(coicop == \"CP041\",\n                               unit == \"RCH_A_AVG\",\n                        !geo %in% c(\"EU27_2020\", \"EA19\", \"EU28\", \n                                     \"EA\", \"EA20\",\"EA19\", \"US\", \n                                     \"XK\", \"TR\", \"RS\", \"AL\", \"MK\", \n                                     \"ME\", \"UK\", \"EEA\", \"EU\")) %>%\n                         rename(país = geo,\n                                año = TIME_PERIOD) %>%\n                         select(-freq) %>%\n                         mutate(año = as.numeric(año))\n\nmapa_europa <- gisco_get_nuts(year = \"2021\", \n                              resolution = \"20\", \n                              nuts_level = 0) %>%\n                rename(país = NUTS_ID)\n\nmapa_animado_data <- mapa_europa %>%\n                      inner_join(df_alquileres_anual, by = \"país\") %>%\n                      mutate(incremento_alquileres_grupos = factor(ntile(values, 5),\n                             labels = c(\"Muy baja\", \n                                        \"Baja\", \n                                        \"Moderado\",\n                                        \"Alta\", \n                                        \"Muy alta\")))\n\nanimacion <- ggplot(mapa_animado_data) +\n              geom_sf(aes(fill = incremento_alquileres_grupos), \n                      color = \"white\", \n                      size = 0.1) +\n              scale_fill_viridis_d(option = \"magma\", direction = -1, \n                       name = \"Incremento del precio del alquiler (%)\") + \n              theme_void() +\n              coord_sf(xlim = c(-25, 45), ylim = c(34, 72)) +\n              labs(title = \"Mapa 1: Evolución del Incremento del alquiler entre 1996-2024 en la UE\",\n                   subtitle = \"Año: {current_frame}\",\n                   caption = \"Eurostat 2025\") +\n              transition_manual(año) +\n              ease_aes(\"linear\") \n\nanimate(animacion, renderer = gifski_renderer(), \n        duration = 35, \n        fps = 25, \n        width = 1000,\n        height = 600,\n        units = \"px\",\n        res = 150)\n```\n\n\n\n","srcMarkdownNoYaml":"\n\n\n\n## Intro \n\nVamos a utilizar datos de:\n\n- Eurostat\n\n. . .\n\n- La  OECD\n\n. . .\n\n- El INE\n\n. . .\n\n*los paquetes han sido cargados en un chunk de codigo que no se ve gracias a \"include: false\".\n```{r}\n#| include: false\n#| message: false\n#| warning: false\n#install.packages(\"eurostat\")\n#install.packages(\"tidyverse\")\n#install.packages(\"ggplot2\")\n#install.packages(\"gganimate\")\n#install.packages(\"ggthemes\")\n#install.packages(\"gt\")\n#install.packages(\"gtExtras\")\n#install.packages(\"tidyr\")\n#install.packages(\"sf\")\n#install.packages(\"giscoR\")\n#install.packages(\"ragg\")\n#install.packages(\"gifski\")\n#install.packages(\"lubridate\")\n#install.packages(\"DT\")\n#install.packages(\"pjpv.curso.R.2022\")\n#install.packages(\"classInt\")\n#install.packages(\"stringr\")\n#install.packages(\"pxR\")\n#install.packages(\"devtools\")\n\nlibrary(pxR)\nlibrary(eurostat)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(gganimate)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\nlibrary(tidyr)\nlibrary(sf)        \nlibrary(giscoR)\nlibrary(ragg)\n\nlibrary(lubridate)\nlibrary(DT)\ndevtools::install_github(\"perezp44/pjpv.curso.R.2022\")\nlibrary(classInt)\nlibrary(stringr)\n\n#Usamos esto para solucionar problemas con los gráficos animados\nlibrary(gifski)\n```\n\n## En Europa donde sube y donde no sube el precio del alquiler {background-color=\"grey\"}\n\n::: {.panel-tabset}\n## Tabla 1 (mal)\n\n```{r}\n#| include: false\n#| eval: true\n#Escogemos los datos de la página de Eurostat\nmy_table <- \"prc_hicp_aind\"\n\neurostat::label_eurostat_tables(my_table)\n\n#Creamos el dataframe asociado al índice de IPC de Eurostat y filtramos\ndf <- eurostat::get_eurostat(my_table, time_format = \"raw\")   \n```\n\n```{r}\n#| echo: false\ndf_alquileres_index <- df %>%\n                        filter(coicop == \"CP041\",\n                        !geo %in% c(\"EU27_2020\", \"EA19\", \"EU28\", \n                                    \"EA\", \"EA20\",\"EA19\", \"US\", \n                                    \"XK\", \"TR\", \"RS\", \"AL\", \"MK\", \n                                    \"ME\", \"UK\", \"EEA\", \"EU\")) %>%\n                        label_eurostat() %>%\n                        filter(unit == \"Annual average index\") %>%\n                        dplyr::rename(paises = geo,\n                               año = TIME_PERIOD) %>%\n                        mutate(año = as.numeric(año)) %>%\n                        select(-freq) \n\n##Top (Los 6 que más han crecido desde 2015 hasta 2024)\ndf_alquileres_top_6_2024 <- df_alquileres_index %>%\n                             filter(año == 2024) %>%\n                             slice_max(values, n=6) \n\ntabla_df_alquileres_top_6_2024 <- df_alquileres_top_6_2024 %>%\n                                   gt() %>%\n                                   gt_theme_excel() %>% \n                                   tab_header(title = \"Tabla 1: Incremento del precio del alquiler\\nen los 6 países que más ha crecido\",\n                                               subtitle = \"TOP 6\") %>% \n                                   tab_footnote(footnote = \"Eurostat 2025\") \n\ntabla_df_alquileres_top_6_2024\n```\n\nAl pasar una tabla de un archivo html a formato slides es necesario realizar ajustes de tamaño de la tabla y el texto que ahi dentro de esta para que se vea bien.\n\n## Tabla 2 (bien)\n\n```{r}\n#| echo: false\n#Nontop (Los 6 que menos han crecido desde 2015 hasta 2024)\ndf_alquileres_nontop_6_2024 <- df_alquileres_index %>%\n                                filter(año == 2024) %>%\n                                slice_min(values, n=6)\n\ntabla_df_alquileres_nontop_6_2024 <- df_alquileres_nontop_6_2024 %>%\n                                gt() %>% \n                                gt_theme_excel() %>% \n                                tab_header(title = \"Tabla 2: Incremento del precio del alquiler\\nen los 6 países que menos ha crecido\",\n                                           subtitle = \"NONTOP 6\") %>% \n                                tab_footnote(footnote = \"Eurostat 2025\") %>%\n                                  gt::tab_options(table.width = pct(100)) %>%\n                                   tab_options(table.font.size = \"18pt\", heading.title.font.size = \"30pt\", data_row.padding = \"8px\") \n\ntabla_df_alquileres_nontop_6_2024\n```\n\n## Código correcto\n\n```{r}\n#| include: true\n#| eval: false\n#Nontop (Los 6 que menos han crecido desde 2015 hasta 2024)\ndf_alquileres_nontop_6_2024 <- df_alquileres_index %>%\n                                filter(año == 2024) %>%\n                                slice_min(values, n=6)\n\ntabla_df_alquileres_nontop_6_2024 <- df_alquileres_nontop_6_2024 %>%\n                                gt() %>% \n                                gt_theme_excel() %>% \n                                tab_header(title = \"Tabla 2: Incremento del precio del alquiler\\nen los 6 países que menos ha crecido\",\n                                           subtitle = \"NONTOP 6\") %>% \n                                tab_footnote(footnote = \"Eurostat 2025\") %>%\n                                  tab_options(table.width = pct(100), table.font.size = \"18pt\", heading.title.font.size = \"30pt\", data_row.padding = \"8px\") \n\ntabla_df_alquileres_nontop_6_2024\n```\n:::\n\n## Grafico y conclusiones\n::: {.incremental}\n:::: {.columns style=\"align-items: center;\"}\n\n::: {.column width=\"50%\"}\n```{r}\n#| echo: false\n#| fig-align: center\n#| fig-height: 9\nurl_ocde <- \"https://sdmx.oecd.org/public/rest/data/OECD.SDD.TPS,DSD_PRICES@DF_PRICES_ALL,1.0/CAN+AUS+BEL+FRA+DEU+ITA+JPN+NLD+ESP+CHE+SWE+GBR+USA+OECD+EU27_2020.A.N.CPI.IX.CP041.N.?startPeriod=1996&endPeriod=2024&dimensionAtObservation=AllDimensions&format=csvfilewithlabels\"\n\n#Creamos el archivo y descargamos los datos\ndir.create(\"datos\")\n\nruta_ocde <- \"./datos/alquileres_ocde.csv\"\n\ncurl::curl_download(url_ocde, ruta_ocde) \n\nalquileres_ocde <- read_csv(ruta_ocde)\n\n#Filtramos los datos\nalquileres_ocde <- alquileres_ocde %>%\n                   select(Measure, BASE_PER, EXPENDITURE, Expenditure,                                         `Reference area`, TIME_PERIOD, OBS_VALUE) %>%\n                   mutate(año = TIME_PERIOD,\n                          values = OBS_VALUE,\n                          país = `Reference area`)\n  \n#Creamos el gráfico \ngráfico <- ggplot(alquileres_ocde, aes(x = año, y = values, color = país)) +\n            geom_line(size = 1.4) +\n            labs(title = \"Gráfico 7: Incremento del precio del alquiler (Base 2015) G-12\", \n                  x = \"Año\", y = \"Porcentaje (Base 2015)\",\n                 caption = \"Fuente: OCDE 2025\") +\n            scale_x_continuous(breaks = seq(1996, 2024, by = 2)) +\n            scale_y_continuous(breaks = seq(50, 150, by = 12.5),\n                               limits = c(50, 150),\n                               expand = c(0, 0)) +\n            theme_stata() +\n            theme(legend.position = \"none\",\n                  axis.text.x = element_text(angle = 90, vjust = 0.5),\n                  axis.text.y = element_text(angle = 0)) +\n            geom_text(aes(label = país))\n  \n#Animámos el gráfico\ngráfico_animado <- gráfico + transition_reveal(año)+\n  enter_fade() + \n  exit_fade()\n\ngráfico_animado\n```\n\n:::\n\n::: {.column width=\"50%\"}\n- Vemos claramente como el año base es 2015.\n\n<br>\n\n- Japón (linea azul) no tiene apenas incremento en el precio de la vivienda.\n\n<br>\n\n- Estados Unidos (rosa), en cambio, lidera la carrera.\n\n:::\n\n::::\n:::\n\n\n\n## Grafico y conclusiones (con tabset)\n::: {.incremental}\n\n:::: {.columns style=\"align-items: center;\"}\n\n::: {.column width=\"50%\"}\n\n::: {.panel-tabset}\n\n## Grafico\n\n```{r}\n#| echo: false\n#| fig-align: center\n#| fig-height: 9\nurl_ocde <- \"https://sdmx.oecd.org/public/rest/data/OECD.SDD.TPS,DSD_PRICES@DF_PRICES_ALL,1.0/CAN+AUS+BEL+FRA+DEU+ITA+JPN+NLD+ESP+CHE+SWE+GBR+USA+OECD+EU27_2020.A.N.CPI.IX.CP041.N.?startPeriod=1996&endPeriod=2024&dimensionAtObservation=AllDimensions&format=csvfilewithlabels\"\n\n#Creamos el archivo y descargamos los datos\ndir.create(\"datos\")\n\nruta_ocde <- \"./datos/alquileres_ocde.csv\"\n\ncurl::curl_download(url_ocde, ruta_ocde) \n\nalquileres_ocde <- read_csv(ruta_ocde)\n\n#Filtramos los datos\nalquileres_ocde <- alquileres_ocde %>%\n                   select(Measure, BASE_PER, EXPENDITURE, Expenditure,                                         `Reference area`, TIME_PERIOD, OBS_VALUE) %>%\n                   mutate(año = TIME_PERIOD,\n                          values = OBS_VALUE,\n                          país = `Reference area`)\n  \n#Creamos el gráfico \ngráfico <- ggplot(alquileres_ocde, aes(x = año, y = values, color = país)) +\n            geom_line(size = 1.4) +\n            labs(title = \"Gráfico 7: Incremento del precio del alquiler (Base 2015) G-12\", \n                  x = \"Año\", y = \"Porcentaje (Base 2015)\",\n                 caption = \"Fuente: OCDE 2025\") +\n            scale_x_continuous(breaks = seq(1996, 2024, by = 2)) +\n            scale_y_continuous(breaks = seq(50, 150, by = 12.5),\n                               limits = c(50, 150),\n                               expand = c(0, 0)) +\n            theme_stata() +\n            theme(legend.position = \"none\",\n                  axis.text.x = element_text(angle = 90, vjust = 0.5),\n                  axis.text.y = element_text(angle = 0)) +\n            geom_text(aes(label = país))\n  \n#Animámos el gráfico\ngráfico_animado <- gráfico + transition_reveal(año)+\n  enter_fade() + \n  exit_fade()\n\ngráfico_animado\n```\n\n## Código\n\n```{r}\n#| include: true\n#| eval: false\n#| fig-align: center\n#| fig-height: 9\nurl_ocde <- \"https://sdmx.oecd.org/public/rest/data/OECD.SDD.TPS,DSD_PRICES@DF_PRICES_ALL,1.0/CAN+AUS+BEL+FRA+DEU+ITA+JPN+NLD+ESP+CHE+SWE+GBR+USA+OECD+EU27_2020.A.N.CPI.IX.CP041.N.?startPeriod=1996&endPeriod=2024&dimensionAtObservation=AllDimensions&format=csvfilewithlabels\"\n\n#Creamos el archivo y descargamos los datos\ndir.create(\"datos\")\n\nruta_ocde <- \"./datos/alquileres_ocde.csv\"\n\ncurl::curl_download(url_ocde, ruta_ocde) \n\nalquileres_ocde <- read_csv(ruta_ocde)\n\n#Filtramos los datos\nalquileres_ocde <- alquileres_ocde %>%\n                   select(Measure, BASE_PER, EXPENDITURE, Expenditure,                                         `Reference area`, TIME_PERIOD, OBS_VALUE) %>%\n                   mutate(año = TIME_PERIOD,\n                          values = OBS_VALUE,\n                          país = `Reference area`)\n  \n#Creamos el gráfico \ngráfico <- ggplot(alquileres_ocde, aes(x = año, y = values, color = país)) +\n            geom_line(size = 1.4) +\n            labs(title = \"Gráfico 7: Incremento del precio del alquiler (Base 2015) G-12\", \n                  x = \"Año\", y = \"Porcentaje (Base 2015)\",\n                 caption = \"Fuente: OCDE 2025\") +\n            scale_x_continuous(breaks = seq(1996, 2024, by = 2)) +\n            scale_y_continuous(breaks = seq(50, 150, by = 12.5),\n                               limits = c(50, 150),\n                               expand = c(0, 0)) +\n            theme_stata() +\n            theme(legend.position = \"none\",\n                  axis.text.x = element_text(angle = 90, vjust = 0.5),\n                  axis.text.y = element_text(angle = 0)) +\n            geom_text(aes(label = país))\n  \n#Animámos el gráfico\ngráfico_animado <- gráfico + transition_reveal(año)+\n  enter_fade() + \n  exit_fade()\n\ngráfico_animado\n```\n\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n- Vemos claramente como el año base es 2015.\n\n<br>\n\n- Japón (linea azul) no tiene apenas incremento en el precio de la vivienda.\n\n<br>\n\n- Estados Unidos (rosa), en cambio, lidera la carrera.\n\n:::\n\n::::\n:::\n\n## Mapa dinámico\n\n```{r}\n#| include: false\n#| eval: true\nmy_table <- \"prc_hicp_aind\"\n\neurostat::label_eurostat_tables(my_table)\n```\n\n\n```{r}\n#| echo: false\n\ndf <- eurostat::get_eurostat(my_table, time_format = \"raw\") \n\ndf_alquileres_anual <- df %>%\n                        filter(coicop == \"CP041\",\n                               unit == \"RCH_A_AVG\",\n                        !geo %in% c(\"EU27_2020\", \"EA19\", \"EU28\", \n                                     \"EA\", \"EA20\",\"EA19\", \"US\", \n                                     \"XK\", \"TR\", \"RS\", \"AL\", \"MK\", \n                                     \"ME\", \"UK\", \"EEA\", \"EU\")) %>%\n                         rename(país = geo,\n                                año = TIME_PERIOD) %>%\n                         select(-freq) %>%\n                         mutate(año = as.numeric(año))\n\nmapa_europa <- gisco_get_nuts(year = \"2021\", \n                              resolution = \"20\", \n                              nuts_level = 0) %>%\n                rename(país = NUTS_ID)\n\nmapa_animado_data <- mapa_europa %>%\n                      inner_join(df_alquileres_anual, by = \"país\") %>%\n                      mutate(incremento_alquileres_grupos = factor(ntile(values, 5),\n                             labels = c(\"Muy baja\", \n                                        \"Baja\", \n                                        \"Moderado\",\n                                        \"Alta\", \n                                        \"Muy alta\")))\n\nanimacion <- ggplot(mapa_animado_data) +\n              geom_sf(aes(fill = incremento_alquileres_grupos), \n                      color = \"white\", \n                      size = 0.1) +\n              scale_fill_viridis_d(option = \"magma\", direction = -1, \n                       name = \"Incremento del precio del alquiler (%)\") + \n              theme_void() +\n              coord_sf(xlim = c(-25, 45), ylim = c(34, 72)) +\n              labs(title = \"Mapa 1: Evolución del Incremento del alquiler entre 1996-2024 en la UE\",\n                   subtitle = \"Año: {current_frame}\",\n                   caption = \"Eurostat 2025\") +\n              transition_manual(año) +\n              ease_aes(\"linear\") \n\nanimate(animacion, renderer = gifski_renderer(), \n        duration = 35, \n        fps = 25, \n        width = 1000,\n        height = 600,\n        units = \"px\",\n        res = 150)\n```\n\n\n\n"},"formats":{"revealjs":{"identifier":{"display-name":"RevealJS","target-format":"revealjs","base-format":"revealjs"},"execute":{"fig-width":10,"fig-height":5,"fig-format":"png","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"show","code-overflow":"wrap","code-link":true,"code-line-numbers":true,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","html-math-method":{"method":"mathjax","url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS_HTML-full"},"slide-level":2,"to":"revealjs","include-in-header":[{"text":"<link rel = \"shortcut icon\" href = \"imagenes/crane_favicon.png\" />\n"}],"toc":false,"toc-depth":3,"highlight-style":"a11y","number-sections":false,"incremental":false,"output-file":"my_slides_BigData.html"},"language":{"toc-title-document":"Indice de contenidos","toc-title-website":"En esta página","related-formats-title":"Otros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fuente","other-links-title":"Otros Enlaces","code-links-title":"Enlaces de código","launch-dev-container-title":"Iniciar Dev Container","launch-binder-title":"Iniciar Binder","article-notebook-label":"Cuaderno de Artículo","notebook-preview-download":"Descargar Cuaderno","notebook-preview-download-src":"Descargar código fuente","notebook-preview-back":"Volver al Artículo","manuscript-meca-bundle":"Archivo MECA","section-title-abstract":"Resumen","section-title-appendices":"Apéndices","section-title-footnotes":"Notas","section-title-references":"Referencias","section-title-reuse":"Reutilizar","section-title-copyright":"Derechos de autor","section-title-citation":"Cita","appendix-attribution-cite-as":"Por favor cita este trabajo como:","appendix-attribution-bibtex":"BibTeX","appendix-view-license":"Ver Licencia","title-block-author-single":"Autor","title-block-author-plural":"Autores/as","title-block-affiliation-single":"Afiliación","title-block-affiliation-plural":"Afiliaciones","title-block-published":"Fecha de Publicación","title-block-modified":"Fecha de modificación","title-block-keywords":"Palabras clave","callout-tip-title":"Tip","callout-note-title":"Nota","callout-warning-title":"Advertencia","callout-important-title":"Importante","callout-caution-title":"Precaución","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Enseñar el código","code-tools-hide-all-code":"Esconder el código","code-tools-view-source":"Ver el código","code-tools-source-code":"Ejecutar el código","tools-share":"Compartir","tools-download":"Descargar","code-line":"Línea","code-lines":"Líneas","copy-button-tooltip":"Copiar al portapapeles","copy-button-tooltip-success":"Copiada","repo-action-links-edit":"Editar esta página","repo-action-links-source":"Ver el código","repo-action-links-issue":"Informar de un problema","back-to-top":"Volver arriba","search-no-results-text":"Sin resultados","search-matching-documents-text":"documentos encontrados","search-copy-link-title":"Copiar el enlace en la busqueda","search-hide-matches-text":"Esconder resultados adicionales","search-more-match-text":"hay más resultados en este documento","search-more-matches-text":"más resultados en este documento","search-clear-button-title":"Borrar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Buscar","toggle-section":"Alternar sección","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo oscuro","toggle-reader-mode":"Alternar modo lector","toggle-navigation":"Navegación de palanca","crossref-fig-title":"Figura","crossref-tbl-title":"Tabla","crossref-lst-title":"Listado","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolario","crossref-prp-title":"Proposición","crossref-cnj-title":"Conjetura","crossref-def-title":"Definición","crossref-exm-title":"Ejemplo","crossref-exr-title":"Ejercicio","crossref-ch-prefix":"Capítulo","crossref-apx-prefix":"Apéndice","crossref-sec-prefix":"Sección","crossref-eq-prefix":"Ecuación","crossref-lof-title":"Listado de Figuras","crossref-lot-title":"Listado de Tablas","crossref-lol-title":"Listado de Listados","environment-proof-title":"Prueba","environment-remark-title":"Observación","environment-solution-title":"Solución","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Pre-seleccionado","listing-page-order-by-date-asc":"Menos reciente","listing-page-order-by-date-desc":"Más reciente","listing-page-order-by-number-desc":"Número de mayor a menor","listing-page-order-by-number-asc":"Número de menor a mayor","listing-page-field-date":"Fecha","listing-page-field-title":"Título","listing-page-field-description":"Descripción","listing-page-field-author":"Autor/a","listing-page-field-filename":"Nombre de Archivo","listing-page-field-filemodified":"Fecha de modificación","listing-page-field-subtitle":"Sub-título","listing-page-field-readingtime":"Tiempo para completar lectura","listing-page-field-wordcount":"Conteo de Palabras","listing-page-field-categories":"Categorías","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Todas","listing-page-no-matches":"No hay resultados","listing-page-words":"{0} palabras","listing-page-filter":"Filtro","draft":"Borrador"},"metadata":{"lang":"es","fig-responsive":false,"quarto-version":"1.7.32","auto-stretch":true,"lightbox":true,"anchor-sections":true,"other-links":[{"text":"Web del curso","href":"https://perezp44.github.io/intro-ds-25-26-web/"},{"text":"Trabajos de mis compañeros","href":"https://perezp44.github.io/intro-ds-25-26-web/05-trabajos-estudiantes.html"},{"text":"Repo del trabajo","href":"https://github.com/juan200210/trabajo_BigData_equipo"}],"toc-location":"left","toc-title":"Índice","crossref":{"fig-title":"Gráfico","tbl-title":"Tabla"},"fig-cap-location":"bottom","code-copy":true,"knitr":{"opts_chunk":{"collapse":true,"comment":"#>","fig.asp":"7/9","out.width":"95%","fig.align":"center","fig.show":"hold","R.options":"options(scipen = 999)"}},"editor_options":{"chunk_output_type":"console"},"license":"CC BY","title":"La vivienda, una mirada a Europa y a España","date":"2025-12-16","date-format":"short","footer":"Slides hechas con [Quarto y con sueño](https://quarto.org/)\n","theme":"night","scrollable":true,"height":900,"width":1600,"center-title-slide":true,"title-slide-attributes":{"data-background-color":"#562457"},"previewLinks":"auto","transition":"fade","fontcolor":"#262d36","slideNumber":"c/t"}}},"projectFormats":["html"]}